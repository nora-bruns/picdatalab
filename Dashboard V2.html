<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Publication Dashboard</title>
  
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
  
  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/dataTables.bootstrap4.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.7.0/css/buttons.bootstrap4.min.css">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  
  <!-- Custom CSS -->
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      padding: 20px;
    }
    .card {
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .card-header {
      font-weight: bold;
      background-color: #f8f9fa;
    }
    .filter-container {
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 5px;
      margin-bottom: 20px;
    }
    .gender-legend {
      background-color: #fff;
      padding: 10px 15px;
      border-radius: 5px;
      margin-top: 10px;
    }
    .journal-legend {
      background-color: #fff;
      padding: 10px 15px;
      border-radius: 5px;
      margin-top: 10px;
    }
    .filter-button {
      margin: 5px 2px;
      border-radius: 4px;
      border: 1px solid #ddd;
      padding: 5px 10px;
      background-color: #f8f9fa;
      cursor: pointer;
      transition: all 0.2s;
      display: block;
      width: 100%;
      text-align: center;
    }
    .filter-button.active {
      background-color: #007bff;
      color: white;
      border-color: #007bff;
    }
    .value-box {
      padding: 15px;
      border-radius: 5px;
      color: white;
      text-align: center;
      margin-bottom: 15px;
      position: relative;
    }
    .value-box h3 {
      font-size: 2rem;
      margin-bottom: 5px;
    }
    .value-box p {
      margin-bottom: 0;
      font-size: 1rem;
    }
    .value-box-primary { background-color: #007bff; }
    .value-box-info { background-color: #17a2b8; }
    .value-box-success { background-color: #28a745; }
    .value-box-warning { background-color: #ffc107; color: #212529; }
    .navbar {
      margin-bottom: 20px;
    }
    .sticky-top {
      top: 20px;
    }
    .table th.sum, .table td.sum { 
      font-weight: bold; 
    }
    .filter-group {
      margin-bottom: 20px;
    }
    .display-toggle {
      text-align: right;
      margin-bottom: 10px;
    }
    .info-icon {
      position: absolute;
      top: 10px;
      right: 10px;
      color: white;
      cursor: help;
    }
    .filter-row {
      margin-top: 20px;
    }
    .filter-label {
      font-weight: bold;
      margin-bottom: 10px;
    }
    .dataTables_length select {
      min-width: 70px;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="#">Publication Dashboard</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#dashboard">Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#summary">Summary</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <!-- Intro Section -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            About this Dashboard
          </div>
          <div class="card-body">
            <p>This dashboard visualizes the gender distribution of first and last authors in scientific publications in high-impact critical care journals from 2005 to 2024. Filters are available for comparisons of total numbers and percentages.</p>
            
            <div class="gender-legend">
              <h5>Gender Combinations:</h5>
              <ul>
                <li><strong>male-male</strong>: Male first author, male last author</li>
                <li><strong>female-male</strong>: Female first author, male last author</li>
                <li><strong>male-female</strong>: Male first author, female last author</li>
                <li><strong>female-female</strong>: Female first author, female last author</li>
              </ul>
            </div>
            
            <div class="journal-legend mt-3">
              <h5>Journal Abbreviations:</h5>
              <ul>
                <li><strong>AJRCCM</strong>: American Journal of Respiratory and Critical Care Medicine</li>
                <li><strong>Chest</strong>: Chest</li>
                <li><strong>Critical Care</strong>: Critical Care</li>
                <li><strong>ICM</strong>: Intensive Care Medicine</li>
                <li><strong>Lancet RM</strong>: The Lancet Respiratory Medicine</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Dashboard Section -->
    <a id="dashboard"></a>
    <div class="row mb-4">
      <!-- Summary Stats -->
      <div class="col-md-3">
        <div class="value-box value-box-primary">
          <h3 id="totalPublications">-</h3>
          <p>Total Publications (2024)</p>
          <i class="fas fa-info-circle info-icon" title="Total number of publications across selected journals in the most recent year"></i>
        </div>
      </div>
      <div class="col-md-3">
        <div class="value-box value-box-info">
          <h3 id="percentFemaleFirst">-</h3>
          <p>% Female First Authors</p>
          <i class="fas fa-info-circle info-icon" title="Percentage of publications with female first authors (includes both female-male and female-female combinations)"></i>
        </div>
      </div>
      <div class="col-md-3">
        <div class="value-box value-box-info">
          <h3 id="percentFemaleLast">-</h3>
          <p>% Female Last Authors</p>
          <i class="fas fa-info-circle info-icon" title="Percentage of publications with female last authors (includes both male-female and female-female combinations)"></i>
        </div>
      </div>
      <div class="col-md-3">
        <div class="value-box value-box-success">
          <h3 id="percentFemaleBoth">-</h3>
          <p>% Female First & Last Authors</p>
          <i class="fas fa-info-circle info-icon" title="Percentage of publications with both female first and last authors (female-female combination only)"></i>
        </div>
      </div>
    </div>

    <div class="row">
      <!-- Filters -->
      <div class="col-md-3">
        <div class="card sticky-top">
          <div class="card-header">
            Filters
          </div>
          <div class="card-body">
            <div class="row filter-row">
              <div class="col-6">
                <div class="filter-label">Journal</div>
                <div id="journalFilters" class="filter-group">
                  <!-- Journal filter buttons will be added here -->
                </div>
              </div>
              
              <div class="col-6">
                <div class="filter-label">Gender Combination</div>
                <div id="genderFilters" class="filter-group">
                  <!-- Gender filter buttons will be added here -->
                </div>
              </div>
            </div>
            
            <button id="resetFilters" class="btn btn-secondary btn-block mt-4">Reset Filters</button>
          </div>
        </div>
      </div>
      
      <!-- Main Content -->
      <div class="col-md-9">
        <!-- Multiple Authors Plot -->
        <div class="card">
          <div class="card-header">
            Multiple author publications by gender combination and journal over time
            <div class="float-right">
              <div class="btn-group btn-group-sm" role="group">
                <button type="button" class="btn btn-outline-primary active" id="multipleAuthorsPercent">Percentage</button>
                <button type="button" class="btn btn-outline-primary" id="multipleAuthorsTotal">Total</button>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div id="multipleAuthorsPlot" style="height: 500px;"></div>
          </div>
        </div>

        <!-- Single Authors Plot -->
        <div class="card mt-4">
          <div class="card-header">
            Single author publications by gender and journal over time
            <div class="float-right">
              <div class="btn-group btn-group-sm" role="group">
                <button type="button" class="btn btn-outline-primary active" id="singleAuthorsPercent">Percentage</button>
                <button type="button" class="btn btn-outline-primary" id="singleAuthorsTotal">Total</button>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div id="singleAuthorsPlot" style="height: 400px;"></div>
          </div>
        </div>
      </div>
    </div>


  <!-- Summary Section -->
 <a id="summary"></a>
 <div class="row mt-4 mb-5">
   <div class="col-12">
     <div class="card">
       <div class="card-header">
         Summary
       </div>
       <div class="card-body">
         <h4>Take-home message:</h4>
         <ul>
           <li>In high-impact critical care journals, women represented only one-third of first authors and less than one fifth of senior authors between 2005 and 2024.</li>
          
           <li>The gender gap was most pronounced in publications by female author pairs (7.8 %) compared to male author pairs (56.7 %).</li>
          
           <li>At the current slow rate of progress, it will take decades to achieve gender parity in critical care research authorship without targeted interventions.</li>
         </ul>
       </div>
     </div>
   </div>
 </div>
 </div>


  <!-- Footer -->
  <footer class="bg-light text-center text-lg-start mt-5">
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.05);">
      Â© 2025 Female Authorship in Critical Care Publications - Dashboard
    </div>
  </footer>

  <!-- Plotly.js -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  
  <!-- jQuery and DataTables -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>

  <!-- Main JavaScript Code -->
  <script>
    // Embedded real data from your CSV for multiple author publications
    const publicationData = [
      {year: 2005, overall_mm: 1133, overall_fm: 366, overall_mf: 162, overall_ff: 83, overall_sum: 1744, AJRCCM_mm: 246, AJRCCM_fm: 86, AJRCCM_mf: 33, AJRCCM_ff: 21, AJRCCM_sum: 386, chest_mm: 566, chest_fm: 201, chest_mf: 95, chest_ff: 46, chest_sum: 908, critcare_mm: 146, critcare_fm: 33, critcare_mf: 19, critcare_ff: 6, critcare_sum: 204, icm_mm: 175, icm_fm: 46, icm_mf: 15, icm_ff: 10, icm_sum: 246, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2006, overall_mm: 886, overall_fm: 295, overall_mf: 177, overall_ff: 85, overall_sum: 1443, AJRCCM_mm: 214, AJRCCM_fm: 89, AJRCCM_mf: 35, AJRCCM_ff: 20, AJRCCM_sum: 358, chest_mm: 294, chest_fm: 105, chest_mf: 70, chest_ff: 43, chest_sum: 512, critcare_mm: 174, critcare_fm: 54, critcare_mf: 38, critcare_ff: 14, critcare_sum: 280, icm_mm: 204, icm_fm: 47, icm_mf: 34, icm_ff: 8, icm_sum: 293, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2007, overall_mm: 905, overall_fm: 312, overall_mf: 161, overall_ff: 72, overall_sum: 1450, AJRCCM_mm: 180, AJRCCM_fm: 76, AJRCCM_mf: 45, AJRCCM_ff: 26, AJRCCM_sum: 327, chest_mm: 354, chest_fm: 124, chest_mf: 61, chest_ff: 33, chest_sum: 572, critcare_mm: 157, critcare_fm: 40, critcare_mf: 29, critcare_ff: 5, critcare_sum: 231, icm_mm: 214, icm_fm: 72, icm_mf: 26, icm_ff: 8, icm_sum: 320, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2008, overall_mm: 844, overall_fm: 280, overall_mf: 131, overall_ff: 80, overall_sum: 1335, AJRCCM_mm: 189, AJRCCM_fm: 94, AJRCCM_mf: 38, AJRCCM_ff: 23, AJRCCM_sum: 344, chest_mm: 267, chest_fm: 86, chest_mf: 51, chest_ff: 29, chest_sum: 433, critcare_mm: 186, critcare_fm: 50, critcare_mf: 24, critcare_ff: 16, critcare_sum: 276, icm_mm: 202, icm_fm: 50, icm_mf: 18, icm_ff: 12, icm_sum: 282, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2009, overall_mm: 835, overall_fm: 293, overall_mf: 138, overall_ff: 81, overall_sum: 1347, AJRCCM_mm: 173, AJRCCM_fm: 63, AJRCCM_mf: 39, AJRCCM_ff: 21, AJRCCM_sum: 296, chest_mm: 267, chest_fm: 101, chest_mf: 50, chest_ff: 28, chest_sum: 446, critcare_mm: 227, critcare_fm: 67, critcare_mf: 24, critcare_ff: 18, critcare_sum: 336, icm_mm: 168, icm_fm: 62, icm_mf: 25, icm_ff: 14, icm_sum: 269, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2010, overall_mm: 890, overall_fm: 325, overall_mf: 154, overall_ff: 99, overall_sum: 1468, AJRCCM_mm: 190, AJRCCM_fm: 95, AJRCCM_mf: 41, AJRCCM_ff: 32, AJRCCM_sum: 358, chest_mm: 265, chest_fm: 102, chest_mf: 43, chest_ff: 34, chest_sum: 444, critcare_mm: 249, critcare_fm: 73, critcare_mf: 42, critcare_ff: 21, critcare_sum: 385, icm_mm: 186, icm_fm: 55, icm_mf: 28, icm_ff: 12, icm_sum: 281, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2011, overall_mm: 904, overall_fm: 380, overall_mf: 188, overall_ff: 92, overall_sum: 1564, AJRCCM_mm: 236, AJRCCM_fm: 126, AJRCCM_mf: 51, AJRCCM_ff: 24, AJRCCM_sum: 437, chest_mm: 233, chest_fm: 100, chest_mf: 75, chest_ff: 31, chest_sum: 439, critcare_mm: 274, critcare_fm: 89, critcare_mf: 45, critcare_ff: 27, critcare_sum: 435, icm_mm: 161, icm_fm: 65, icm_mf: 17, icm_ff: 10, icm_sum: 253, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2012, overall_mm: 901, overall_fm: 358, overall_mf: 174, overall_ff: 97, overall_sum: 1530, AJRCCM_mm: 239, AJRCCM_fm: 110, AJRCCM_mf: 67, AJRCCM_ff: 26, AJRCCM_sum: 442, chest_mm: 269, chest_fm: 116, chest_mf: 52, chest_ff: 30, chest_sum: 467, critcare_mm: 242, critcare_fm: 79, critcare_mf: 37, critcare_ff: 18, critcare_sum: 376, icm_mm: 151, icm_fm: 53, icm_mf: 18, icm_ff: 23, icm_sum: 245, lancet_mm: null, lancet_fm: null, lancet_mf: null, lancet_ff: null, lancet_sum: null},
      {year: 2013, overall_mm: 1106, overall_fm: 476, overall_mf: 246, overall_ff: 119, overall_sum: 1947, AJRCCM_mm: 274, AJRCCM_fm: 137, AJRCCM_mf: 59, AJRCCM_ff: 32, AJRCCM_sum: 502, chest_mm: 315, chest_fm: 145, chest_mf: 88, chest_ff: 34, chest_sum: 582, critcare_mm: 297, critcare_fm: 109, critcare_mf: 55, critcare_ff: 30, critcare_sum: 491, icm_mm: 178, icm_fm: 56, icm_mf: 30, icm_ff: 12, icm_sum: 276, lancet_mm: 42, lancet_fm: 29, lancet_mf: 14, lancet_ff: 11, lancet_sum: 96},
      {year: 2014, overall_mm: 1084, overall_fm: 454, overall_mf: 248, overall_ff: 168, overall_sum: 1954, AJRCCM_mm: 237, AJRCCM_fm: 131, AJRCCM_mf: 65, AJRCCM_ff: 60, AJRCCM_sum: 493, chest_mm: 284, chest_fm: 120, chest_mf: 70, chest_ff: 46, chest_sum: 520, critcare_mm: 296, critcare_fm: 130, critcare_mf: 48, critcare_ff: 38, critcare_sum: 512, icm_mm: 201, icm_fm: 44, icm_mf: 43, icm_ff: 15, icm_sum: 303, lancet_mm: 66, lancet_fm: 29, lancet_mf: 22, lancet_ff: 9, lancet_sum: 126},
      {year: 2015, overall_mm: 1081, overall_fm: 439, overall_mf: 201, overall_ff: 151, overall_sum: 1872, AJRCCM_mm: 241, AJRCCM_fm: 115, AJRCCM_mf: 68, AJRCCM_ff: 41, AJRCCM_sum: 465, chest_mm: 283, chest_fm: 123, chest_mf: 51, chest_ff: 43, chest_sum: 500, critcare_mm: 233, critcare_fm: 101, critcare_mf: 33, critcare_ff: 31, critcare_sum: 398, icm_mm: 254, icm_fm: 67, icm_mf: 38, icm_ff: 25, icm_sum: 384, lancet_mm: 70, lancet_fm: 33, lancet_mf: 11, lancet_ff: 11, lancet_sum: 125},
      {year: 2016, overall_mm: 1013, overall_fm: 424, overall_mf: 206, overall_ff: 118, overall_sum: 1761, AJRCCM_mm: 239, AJRCCM_fm: 131, AJRCCM_mf: 71, AJRCCM_ff: 45, AJRCCM_sum: 486, chest_mm: 236, chest_fm: 117, chest_mf: 54, chest_ff: 38, chest_sum: 445, critcare_mm: 214, critcare_fm: 69, critcare_mf: 32, critcare_ff: 14, critcare_sum: 329, icm_mm: 244, icm_fm: 75, icm_mf: 31, icm_ff: 13, icm_sum: 363, lancet_mm: 80, lancet_fm: 32, lancet_mf: 18, lancet_ff: 8, lancet_sum: 138},
      {year: 2017, overall_mm: 935, overall_fm: 366, overall_mf: 218, overall_ff: 130, overall_sum: 1649, AJRCCM_mm: 273, AJRCCM_fm: 112, AJRCCM_mf: 87, AJRCCM_ff: 54, AJRCCM_sum: 526, chest_mm: 224, chest_fm: 107, chest_mf: 52, chest_ff: 34, chest_sum: 417, critcare_mm: 166, critcare_fm: 61, critcare_mf: 29, critcare_ff: 15, critcare_sum: 271, icm_mm: 198, icm_fm: 61, icm_mf: 30, icm_ff: 18, icm_sum: 307, lancet_mm: 74, lancet_fm: 25, lancet_mf: 20, lancet_ff: 9, lancet_sum: 128},
      {year: 2018, overall_mm: 1007, overall_fm: 404, overall_mf: 275, overall_ff: 129, overall_sum: 1815, AJRCCM_mm: 293, AJRCCM_fm: 135, AJRCCM_mf: 78, AJRCCM_ff: 47, AJRCCM_sum: 553, chest_mm: 239, chest_fm: 99, chest_mf: 87, chest_ff: 31, chest_sum: 456, critcare_mm: 161, critcare_fm: 62, critcare_mf: 37, critcare_ff: 25, critcare_sum: 285, icm_mm: 232, icm_fm: 80, icm_mf: 49, icm_ff: 13, icm_sum: 374, lancet_mm: 82, lancet_fm: 28, lancet_mf: 24, lancet_ff: 13, lancet_sum: 147},
      {year: 2019, overall_mm: 1003, overall_fm: 385, overall_mf: 222, overall_ff: 144, overall_sum: 1754, AJRCCM_mm: 304, AJRCCM_fm: 138, AJRCCM_mf: 80, AJRCCM_ff: 51, AJRCCM_sum: 573, chest_mm: 210, chest_fm: 92, chest_mf: 51, chest_ff: 33, chest_sum: 386, critcare_mm: 236, critcare_fm: 73, critcare_mf: 29, critcare_ff: 30, critcare_sum: 368, icm_mm: 178, icm_fm: 57, icm_mf: 41, icm_ff: 17, icm_sum: 293, lancet_mm: 75, lancet_fm: 25, lancet_mf: 21, lancet_ff: 13, lancet_sum: 134},
      {year: 2020, overall_mm: 1340, overall_fm: 604, overall_mf: 340, overall_ff: 243, overall_sum: 2527, AJRCCM_mm: 341, AJRCCM_fm: 177, AJRCCM_mf: 98, AJRCCM_ff: 87, AJRCCM_sum: 703, chest_mm: 328, chest_fm: 187, chest_mf: 105, chest_ff: 71, chest_sum: 691, critcare_mm: 352, critcare_fm: 123, critcare_mf: 77, critcare_ff: 54, critcare_sum: 606, icm_mm: 202, icm_fm: 78, icm_mf: 38, icm_ff: 17, icm_sum: 335, lancet_mm: 117, lancet_fm: 39, lancet_mf: 22, lancet_ff: 14, lancet_sum: 192},
      {year: 2021, overall_mm: 1091, overall_fm: 516, overall_mf: 301, overall_ff: 206, overall_sum: 2114, AJRCCM_mm: 258, AJRCCM_fm: 160, AJRCCM_mf: 89, AJRCCM_ff: 56, AJRCCM_sum: 563, chest_mm: 395, chest_fm: 201, chest_mf: 107, chest_ff: 94, chest_sum: 797, critcare_mm: 209, critcare_fm: 86, critcare_mf: 45, critcare_ff: 26, critcare_sum: 366, icm_mm: 116, icm_fm: 29, icm_mf: 26, icm_ff: 18, icm_sum: 189, lancet_mm: 113, lancet_fm: 40, lancet_mf: 34, lancet_ff: 12, lancet_sum: 199},
      {year: 2022, overall_mm: 883, overall_fm: 417, overall_mf: 282, overall_ff: 175, overall_sum: 1757, AJRCCM_mm: 239, AJRCCM_fm: 116, AJRCCM_mf: 81, AJRCCM_ff: 65, AJRCCM_sum: 501, chest_mm: 240, chest_fm: 143, chest_mf: 87, chest_ff: 47, chest_sum: 517, critcare_mm: 174, critcare_fm: 73, critcare_mf: 39, critcare_ff: 32, critcare_sum: 318, icm_mm: 154, icm_fm: 51, icm_mf: 39, icm_ff: 20, icm_sum: 264, lancet_mm: 76, lancet_fm: 34, lancet_mf: 36, lancet_ff: 11, lancet_sum: 157},
      {year: 2023, overall_mm: 894, overall_fm: 449, overall_mf: 259, overall_ff: 193, overall_sum: 1795, AJRCCM_mm: 251, AJRCCM_fm: 135, AJRCCM_mf: 68, AJRCCM_ff: 67, AJRCCM_sum: 521, chest_mm: 216, chest_fm: 121, chest_mf: 81, chest_ff: 44, chest_sum: 462, critcare_mm: 213, critcare_fm: 96, critcare_mf: 66, critcare_ff: 34, critcare_sum: 409, icm_mm: 142, icm_fm: 59, icm_mf: 25, icm_ff: 28, icm_sum: 254, lancet_mm: 72, lancet_fm: 38, lancet_mf: 19, lancet_ff: 20, lancet_sum: 149},
      {year: 2024, overall_mm: 947, overall_fm: 469, overall_mf: 270, overall_ff: 231, overall_sum: 1917, AJRCCM_mm: 274, AJRCCM_fm: 141, AJRCCM_mf: 79, AJRCCM_ff: 78, AJRCCM_sum: 572, chest_mm: 236, chest_fm: 144, chest_mf: 70, chest_ff: 65, chest_sum: 515, critcare_mm: 188, critcare_fm: 88, critcare_mf: 49, critcare_ff: 36, critcare_sum: 361, icm_mm: 196, icm_fm: 67, icm_mf: 50, icm_ff: 36, icm_sum: 349, lancet_mm: 53, lancet_fm: 29, lancet_mf: 22, lancet_ff: 16, lancet_sum: 120}
    ];

    // Real data from the CSV for single author publications
    const singleAuthorData = [
      {year: 2005, overall_f: 42, overall_m: 318, overall_sum: 360, AJRCCM_f: 11, AJRCCM_m: 76, AJRCCM_sum: 87, chest_f: 14, chest_m: 157, chest_sum: 171, critcare_f: 14, critcare_m: 50, critcare_sum: 64, icm_f: 3, icm_m: 35, icm_sum: 38, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2006, overall_f: 39, overall_m: 294, overall_sum: 333, AJRCCM_f: 14, AJRCCM_m: 66, AJRCCM_sum: 80, chest_f: 17, chest_m: 120, chest_sum: 137, critcare_f: 3, critcare_m: 55, critcare_sum: 58, icm_f: 5, icm_m: 53, icm_sum: 58, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2007, overall_f: 39, overall_m: 264, overall_sum: 303, AJRCCM_f: 12, AJRCCM_m: 70, AJRCCM_sum: 82, chest_f: 15, chest_m: 116, chest_sum: 131, critcare_f: 9, critcare_m: 45, critcare_sum: 54, icm_f: 3, icm_m: 33, icm_sum: 36, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2008, overall_f: 54, overall_m: 239, overall_sum: 293, AJRCCM_f: 13, AJRCCM_m: 68, AJRCCM_sum: 81, chest_f: 21, chest_m: 73, chest_sum: 94, critcare_f: 11, critcare_m: 57, critcare_sum: 68, icm_f: 9, icm_m: 41, icm_sum: 50, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2009, overall_f: 55, overall_m: 234, overall_sum: 289, AJRCCM_f: 20, AJRCCM_m: 62, AJRCCM_sum: 82, chest_f: 21, chest_m: 80, chest_sum: 101, critcare_f: 7, critcare_m: 59, critcare_sum: 66, icm_f: 7, icm_m: 33, icm_sum: 40, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2010, overall_f: 49, overall_m: 227, overall_sum: 276, AJRCCM_f: 16, AJRCCM_m: 61, AJRCCM_sum: 77, chest_f: 12, chest_m: 70, chest_sum: 82, critcare_f: 18, critcare_m: 61, critcare_sum: 79, icm_f: 3, icm_m: 35, icm_sum: 38, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2011, overall_f: 54, overall_m: 276, overall_sum: 330, AJRCCM_f: 23, AJRCCM_m: 103, AJRCCM_sum: 126, chest_f: 13, chest_m: 79, chest_sum: 92, critcare_f: 12, critcare_m: 71, critcare_sum: 83, icm_f: 6, icm_m: 23, icm_sum: 29, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2012, overall_f: 55, overall_m: 249, overall_sum: 304, AJRCCM_f: 17, AJRCCM_m: 93, AJRCCM_sum: 110, chest_f: 21, chest_m: 74, chest_sum: 95, critcare_f: 12, critcare_m: 63, critcare_sum: 75, icm_f: 5, icm_m: 19, icm_sum: 24, lancet_f: null, lancet_m: null, lancet_sum: null},
      {year: 2013, overall_f: 117, overall_m: 413, overall_sum: 530, AJRCCM_f: 21, AJRCCM_m: 98, AJRCCM_sum: 119, chest_f: 21, chest_m: 108, chest_sum: 129, critcare_f: 18, critcare_m: 83, critcare_sum: 101, icm_f: 6, icm_m: 50, icm_sum: 56, lancet_f: 51, lancet_m: 74, lancet_sum: 125},
      {year: 2014, overall_f: 116, overall_m: 372, overall_sum: 488, AJRCCM_f: 26, AJRCCM_m: 97, AJRCCM_sum: 123, chest_f: 24, chest_m: 108, chest_sum: 132, critcare_f: 15, critcare_m: 59, critcare_sum: 74, icm_f: 7, icm_m: 27, icm_sum: 34, lancet_f: 44, lancet_m: 81, lancet_sum: 125},
      {year: 2015, overall_f: 136, overall_m: 384, overall_sum: 520, AJRCCM_f: 20, AJRCCM_m: 102, AJRCCM_sum: 122, chest_f: 27, chest_m: 84, chest_sum: 111, critcare_f: 20, critcare_m: 42, critcare_sum: 62, icm_f: 5, icm_m: 48, icm_sum: 53, lancet_f: 64, lancet_m: 108, lancet_sum: 172},
      {year: 2016, overall_f: 141, overall_m: 356, overall_sum: 497, AJRCCM_f: 31, AJRCCM_m: 85, AJRCCM_sum: 116, chest_f: 26, chest_m: 82, chest_sum: 108, critcare_f: 7, critcare_m: 46, critcare_sum: 53, icm_f: 11, icm_m: 48, icm_sum: 59, lancet_f: 66, lancet_m: 95, lancet_sum: 161},
      {year: 2017, overall_f: 104, overall_m: 356, overall_sum: 460, AJRCCM_f: 32, AJRCCM_m: 118, AJRCCM_sum: 150, chest_f: 19, chest_m: 75, chest_sum: 94, critcare_f: 9, critcare_m: 34, critcare_sum: 43, icm_f: 7, icm_m: 35, icm_sum: 42, lancet_f: 37, lancet_m: 94, lancet_sum: 131},
      {year: 2018, overall_f: 119, overall_m: 360, overall_sum: 479, AJRCCM_f: 28, AJRCCM_m: 109, AJRCCM_sum: 137, chest_f: 16, chest_m: 76, chest_sum: 92, critcare_f: 11, critcare_m: 48, critcare_sum: 59, icm_f: 15, icm_m: 51, icm_sum: 66, lancet_f: 49, lancet_m: 76, lancet_sum: 125},
      {year: 2019, overall_f: 107, overall_m: 284, overall_sum: 391, AJRCCM_f: 24, AJRCCM_m: 75, AJRCCM_sum: 99, chest_f: 24, chest_m: 61, chest_sum: 85, critcare_f: 15, critcare_m: 34, critcare_sum: 49, icm_f: 4, icm_m: 42, icm_sum: 46, lancet_f: 40, lancet_m: 72, lancet_sum: 112},
      {year: 2020, overall_f: 165, overall_m: 355, overall_sum: 520, AJRCCM_f: 34, AJRCCM_m: 69, AJRCCM_sum: 103, chest_f: 34, chest_m: 88, chest_sum: 122, critcare_f: 28, critcare_m: 56, critcare_sum: 84, icm_f: 21, icm_m: 59, icm_sum: 80, lancet_f: 48, lancet_m: 83, lancet_sum: 131},
      {year: 2021, overall_f: 153, overall_m: 382, overall_sum: 535, AJRCCM_f: 23, AJRCCM_m: 77, AJRCCM_sum: 100, chest_f: 42, chest_m: 112, chest_sum: 154, critcare_f: 21, critcare_m: 51, critcare_sum: 72, icm_f: 18, icm_m: 56, icm_sum: 74, lancet_f: 49, lancet_m: 86, lancet_sum: 135},
      {year: 2022, overall_f: 128, overall_m: 321, overall_sum: 449, AJRCCM_f: 28, AJRCCM_m: 69, AJRCCM_sum: 97, chest_f: 21, chest_m: 72, chest_sum: 93, critcare_f: 23, critcare_m: 50, critcare_sum: 73, icm_f: 15, icm_m: 63, icm_sum: 78, lancet_f: 41, lancet_m: 67, lancet_sum: 108},
      {year: 2023, overall_f: 138, overall_m: 297, overall_sum: 435, AJRCCM_f: 30, AJRCCM_m: 63, AJRCCM_sum: 93, chest_f: 27, chest_m: 42, chest_sum: 69, critcare_f: 22, critcare_m: 44, critcare_sum: 66, icm_f: 18, icm_m: 62, icm_sum: 80, lancet_f: 41, lancet_m: 86, lancet_sum: 127},
      {year: 2024, overall_f: 134, overall_m: 301, overall_sum: 435, AJRCCM_f: 28, AJRCCM_m: 71, AJRCCM_sum: 99, chest_f: 29, chest_m: 64, chest_sum: 93, critcare_f: 18, critcare_m: 49, critcare_sum: 67, icm_f: 23, icm_m: 52, icm_sum: 75, lancet_f: 36, lancet_m: 65, lancet_sum: 101}
    ];

    // Mappings for display names
    const journalDisplayNames = {
      'overall': 'Overall',
      'AJRCCM': 'AJRCCM',
      'chest': 'Chest',
      'critcare': 'Critical Care',
      'icm': 'ICM',
      'lancet': 'Lancet RM'
    };

    // Gender-Labels for display
    const genderLabels = {
      'mm': 'male-male',
      'mf': 'male-female',
      'fm': 'female-male',
      'ff': 'female-female',
      'm': 'male',
      'f': 'female'
    };

    // Display mode tracking
    let multipleAuthorsMode = 'percent'; // 'percent' or 'total'
    let singleAuthorsMode = 'percent'; // 'percent' or 'total'

    // Extract journals and gender combinations from the data
    function extractJournalsAndGenders() {
      // Extract all column names (except 'year')
      const columns = Object.keys(publicationData[0]).filter(key => key !== 'year');
      
      // Extract journals and gender combinations
      const journals = new Set();
      const genders = new Set();
      
      columns.forEach(column => {
        const parts = column.split('_');
        if (parts.length === 2) {
          const journal = parts[0];
          const gender = parts[1];
          
          if (gender !== 'sum') {
            journals.add(journal);
            genders.add(gender);
          }
        }
      });
      
      return {
        journals: Array.from(journals),
        genders: Array.from(genders).filter(g => g !== 'm' && g !== 'f') // Filter out single author genders
      };
    }

    // Create filter buttons
    function createFilterButtons() {
      const { journals, genders } = extractJournalsAndGenders();
      
      // Journal filters
      const journalContainer = document.getElementById('journalFilters');
      journals.forEach(journal => {
        const button = document.createElement('span');
        button.classList.add('filter-button');
        button.setAttribute('data-journal', journal);
        button.textContent = journalDisplayNames[journal];
        button.addEventListener('click', toggleJournalFilter);
        
        // Set only 'overall' as active by default
        if (journal === 'overall') {
          button.classList.add('active');
        }
        
        journalContainer.appendChild(button);
      });
      
      // Gender filters
      const genderContainer = document.getElementById('genderFilters');
      genders.forEach(gender => {
        const button = document.createElement('span');
        button.classList.add('filter-button', 'active'); // All gender filters active by default
        button.setAttribute('data-gender', gender);
        button.textContent = genderLabels[gender];
        button.title = genderLabels[gender];
        button.addEventListener('click', toggleGenderFilter);
        genderContainer.appendChild(button);
      });
      
      // Reset button
      document.getElementById('resetFilters').addEventListener('click', resetFilters);
      
      // Toggle buttons for percentage/total views
      document.getElementById('multipleAuthorsPercent').addEventListener('click', function() {
        document.getElementById('multipleAuthorsTotal').classList.remove('active');
        this.classList.add('active');
        multipleAuthorsMode = 'percent';
        createMultipleAuthorsPlot();
      });
      
      document.getElementById('multipleAuthorsTotal').addEventListener('click', function() {
        document.getElementById('multipleAuthorsPercent').classList.remove('active');
        this.classList.add('active');
        multipleAuthorsMode = 'total';
        createMultipleAuthorsPlot();
      });
      
      document.getElementById('singleAuthorsPercent').addEventListener('click', function() {
        document.getElementById('singleAuthorsTotal').classList.remove('active');
        this.classList.add('active');
        singleAuthorsMode = 'percent';
        createSingleAuthorsPlot();
      });
      
      document.getElementById('singleAuthorsTotal').addEventListener('click', function() {
        document.getElementById('singleAuthorsPercent').classList.remove('active');
        this.classList.add('active');
        singleAuthorsMode = 'total';
        createSingleAuthorsPlot();
      });
    }

    // Toggle Journal Filter
    function toggleJournalFilter(event) {
      const button = event.target;
      button.classList.toggle('active');
      updateCharts();
      updateTable();
    }

    // Toggle Gender Filter
    function toggleGenderFilter(event) {
      const button = event.target;
      button.classList.toggle('active');
      updateCharts();
      updateTable();
    }

    // Reset Filters
    function resetFilters() {
      // Set only 'overall' journal as active
      document.querySelectorAll('.filter-button[data-journal]').forEach(button => {
        button.classList.remove('active');
        if (button.getAttribute('data-journal') === 'overall') {
          button.classList.add('active');
        }
      });
      
      // Set all gender combinations as active
      document.querySelectorAll('.filter-button[data-gender]').forEach(button => {
        button.classList.add('active');
      });
      
      updateCharts();
      updateTable();
    }

    // Get active filters
    function getActiveFilters() {
      const activeJournals = Array.from(document.querySelectorAll('.filter-button[data-journal].active')).map(button => button.getAttribute('data-journal'));
      const activeGenders = Array.from(document.querySelectorAll('.filter-button[data-gender].active')).map(button => button.getAttribute('data-gender'));
      
      return { activeJournals, activeGenders };
    }

    // Create the multiple authors plot
    function createMultipleAuthorsPlot() {
      const { activeJournals, activeGenders } = getActiveFilters();
      
      // Prepare data for the plot
      const traces = [];
      const years = publicationData.map(d => d.year);
      
      // Custom range of years for x-axis
      const xAxisRange = [2004.5, 2024.5]; // This will hide 2004 and 2025 labels
      
      // Color palette for the different journals
      const colors = {
        'overall': '#1f77b4',
        'AJRCCM': '#ff7f0e',
        'chest': '#2ca02c',
        'critcare': '#d62728',
        'icm': '#9467bd',
        'lancet': '#8c564b'
      };
      
      // Line dash styles for gender combinations
      const dashStyles = {
        'mm': 'solid',
        'mf': 'dot',
        'fm': 'dashdot',
        'ff': 'dash'
      };
      
      // Create a line for each active journal and gender combination
      activeJournals.forEach(journal => {
        activeGenders.forEach(gender => {
          const key = `${journal}_${gender}`;
          
          // Get values and calculate percentages if needed
          const values = publicationData.map(d => {
            if (d[key] === null || d[key] === undefined || d[`${journal}_sum`] === 0) {
              return null; // Handle missing data
            }
            
            if (multipleAuthorsMode === 'percent') {
              return (d[key] / d[`${journal}_sum`]) * 100;
            } else {
              return d[key];
            }
          });
          
          traces.push({
            x: years,
            y: values,
            mode: 'lines+markers',
            type: 'scatter',
            name: `${journalDisplayNames[journal]} (${genderLabels[gender]})`,
            line: {
              color: colors[journal] || '#000000',
              width: 2,
              dash: dashStyles[gender] || 'solid'
            },
            marker: {
              size: 6,
              opacity: 0.7
            },
            hoverinfo: 'text',
            hovertemplate: 
              '<span style="font-weight:bold; color:' + (colors[journal] || '#000000') + ';">' + journalDisplayNames[journal] + '</span><br>' +
              'Gender: ' + genderLabels[gender] + '<br>' +
              'Year: %{x}<br>' +
              (multipleAuthorsMode === 'percent' ? 
                'Percentage: %{y:.1f}%' : 
                'Publications: %{y}'),
            hoverlabel: {
              bgcolor: 'white',
              bordercolor: colors[journal] || '#000000',
              font: {color: 'black'}
            }
          });
        });
      });
      
      const layout = {
        title: {
          text: 'Multiple author publications by gender combination and journal over time',
          font: {
            size: 16
          }
        },
        xaxis: {
          title: 'Year',
          range: xAxisRange,
          tickmode: 'linear',
          tick0: Math.min(...years),
          dtick: 1
        },
        yaxis: {
          title: multipleAuthorsMode === 'percent' ? 'Percentage (%)' : 'Number of Publications'
        },
        hovermode: 'closest',
        legend: {
          orientation: 'h',
          y: -0.2
        },
        margin: {
          l: 60,
          r: 30,
          t: 60,
          b: 100
        }
      };
      
      Plotly.newPlot('multipleAuthorsPlot', traces, layout, {responsive: true});
    }

    // Create the single authors plot
    function createSingleAuthorsPlot() {
      const { activeJournals } = getActiveFilters();
      
      // Prepare data for the plot
      const traces = [];
      const years = singleAuthorData.map(d => d.year);
      
      // Custom range of years for x-axis
      const xAxisRange = [2004.5, 2024.5]; // This will hide 2004 and 2025 labels
      
      // Color palette for the different journals
      const colors = {
        'overall': '#1f77b4',
        'AJRCCM': '#ff7f0e',
        'chest': '#2ca02c',
        'critcare': '#d62728',
        'icm': '#9467bd',
        'lancet': '#8c564b'
      };
      
      // Line dash styles for gender
      const dashStyles = {
        'm': 'solid',
        'f': 'dash'
      };
      
      // Create a line for each active journal and gender
      activeJournals.forEach(journal => {
        ['m', 'f'].forEach(gender => {
          const key = `${journal}_${gender}`;
          
          // Get values and calculate percentages if needed
          const values = singleAuthorData.map(d => {
            if (d[key] === null || d[key] === undefined || d[`${journal}_sum`] === 0) {
              return null; // Handle missing data
            }
            
            if (singleAuthorsMode === 'percent') {
              return (d[key] / d[`${journal}_sum`]) * 100;
            } else {
              return d[key];
            }
          });
          
          traces.push({
            x: years,
            y: values,
            mode: 'lines+markers',
            type: 'scatter',
            name: `${journalDisplayNames[journal]} (${gender === 'm' ? 'male' : 'female'})`,
            line: {
              color: colors[journal] || '#000000',
              width: 2,
              dash: dashStyles[gender] || 'solid'
            },
            marker: {
              size: 6,
              opacity: 0.7
            },
            hoverinfo: 'text',
            hovertemplate: 
              '<span style="font-weight:bold; color:' + (colors[journal] || '#000000') + ';">' + journalDisplayNames[journal] + '</span><br>' +
              'Gender: ' + (gender === 'm' ? 'male' : 'female') + '<br>' +
              'Year: %{x}<br>' +
              (singleAuthorsMode === 'percent' ? 
                'Percentage: %{y:.1f}%' : 
                'Publications: %{y}'),
            hoverlabel: {
              bgcolor: 'white',
              bordercolor: colors[journal] || '#000000',
              font: {color: 'black'}
            }
          });
        });
      });
      
      const layout = {
        title: {
          text: 'Single author publications by gender and journal over time',
          font: {
            size: 16
          }
        },
        xaxis: {
          title: 'Year',
          range: xAxisRange,
          tickmode: 'linear',
          tick0: Math.min(...years),
          dtick: 1
        },
        yaxis: {
          title: singleAuthorsMode === 'percent' ? 'Percentage (%)' : 'Number of Publications'
        },
        hovermode: 'closest',
        legend: {
          orientation: 'h',
          y: -0.2
        },
        margin: {
          l: 60,
          r: 30,
          t: 60,
          b: 100
        }
      };
      
      Plotly.newPlot('singleAuthorsPlot', traces, layout, {responsive: true});
    }

    // Update summary statistics (avoid double-counting Overall when multiple journals are selected)
    function updateSummaryStats() {
      const { activeJournals } = getActiveFilters();
      const latestYear = publicationData[publicationData.length - 1];
      
      // If 'overall' is selected along with other journals, only use 'overall'
      let journalsToUse = activeJournals.includes('overall') ? ['overall'] : activeJournals;
      
      // Calculate total publications
      let totalPapers = 0;
      journalsToUse.forEach(journal => {
        totalPapers += latestYear[`${journal}_sum`] || 0;
      });
      
      // Calculate percentages for female authors
      let totalFemaleFirst = 0;
      let totalFemaleLast = 0;
      let totalFemaleBoth = 0;
      
      journalsToUse.forEach(journal => {
        totalFemaleFirst += (latestYear[`${journal}_fm`] || 0) + (latestYear[`${journal}_ff`] || 0);
        totalFemaleLast += (latestYear[`${journal}_mf`] || 0) +(latestYear[`${journal}_ff`] || 0);
        totalFemaleBoth += latestYear[`${journal}_ff`] || 0;
      });
      
      const percentFemaleFirst = (totalFemaleFirst / totalPapers) * 100;
      const percentFemaleLast = (totalFemaleLast / totalPapers) * 100;
      const percentFemaleBoth = (totalFemaleBoth / totalPapers) * 100;
      
      // Display values
      document.getElementById('totalPublications').textContent = totalPapers.toLocaleString('en-US');
      document.getElementById('percentFemaleFirst').textContent = percentFemaleFirst.toFixed(1) + '%';
      document.getElementById('percentFemaleLast').textContent = percentFemaleLast.toFixed(1) + '%';
      document.getElementById('percentFemaleBoth').textContent = percentFemaleBoth.toFixed(1) + '%';
    }

    // Create and update the data table with gender columns
    function updateTable() {
      const { activeJournals, activeGenders } = getActiveFilters();
      const tableBody = document.getElementById('tableBody');
      
      // Clear existing table rows
      tableBody.innerHTML = '';
      
      // Create table rows - one row per journal per year
      publicationData.forEach(yearData => {
        // If 'overall' is selected along with other journals, only use 'overall' for clarity
        let journalsToUse = activeJournals.includes('overall') ? ['overall'] : activeJournals;
        
        journalsToUse.forEach(journal => {
          const tr = document.createElement('tr');
          
          // Year column
          const yearTd = document.createElement('td');
          yearTd.textContent = yearData.year;
          tr.appendChild(yearTd);
          
          // Journal column
          const journalTd = document.createElement('td');
          journalTd.textContent = journalDisplayNames[journal];
          tr.appendChild(journalTd);
          
          // Gender columns - one for each gender combination
          // male-male column
          const mmTd = document.createElement('td');
          mmTd.textContent = (yearData[`${journal}_mm`] !== null && yearData[`${journal}_mm`] !== undefined) ? 
                            yearData[`${journal}_mm`].toLocaleString('en-US') : '';
          mmTd.classList.add('mm');
          tr.appendChild(mmTd);
          
          // female-male column
          const fmTd = document.createElement('td');
          fmTd.textContent = (yearData[`${journal}_fm`] !== null && yearData[`${journal}_fm`] !== undefined) ? 
                            yearData[`${journal}_fm`].toLocaleString('en-US') : '';
          fmTd.classList.add('fm');
          tr.appendChild(fmTd);
          
          // male-female column
          const mfTd = document.createElement('td');
          mfTd.textContent = (yearData[`${journal}_mf`] !== null && yearData[`${journal}_mf`] !== undefined) ? 
                            yearData[`${journal}_mf`].toLocaleString('en-US') : '';
          mfTd.classList.add('mf');
          tr.appendChild(mfTd);
          
          // female-female column
          const ffTd = document.createElement('td');
          ffTd.textContent = (yearData[`${journal}_ff`] !== null && yearData[`${journal}_ff`] !== undefined) ? 
                            yearData[`${journal}_ff`].toLocaleString('en-US') : '';
          ffTd.classList.add('ff');
          tr.appendChild(ffTd);
          
          // Total column
          const totalTd = document.createElement('td');
          totalTd.textContent = (yearData[`${journal}_sum`] !== null && yearData[`${journal}_sum`] !== undefined) ? 
                               yearData[`${journal}_sum`].toLocaleString('en-US') : '';
          totalTd.classList.add('sum');
          tr.appendChild(totalTd);
          
          // Only add the row if at least one of the gender combinations is selected
          const hasSelectedGender = activeGenders.some(gender => 
            yearData[`${journal}_${gender}`] !== null && yearData[`${journal}_${gender}`] !== undefined
          );
          
          if (hasSelectedGender) {
            tableBody.appendChild(tr);
          }
        });
      });
      
      // Initialize or refresh DataTable
      if ($.fn.DataTable.isDataTable('#publicationTable')) {
        $('#publicationTable').DataTable().destroy();
      }
      
      $('#publicationTable').DataTable({
        paging: true,
        pageLength: 25, // Show more rows by default
        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]], // Allow selecting number of rows
        ordering: true,
        order: [[0, 'desc'], [1, 'asc']], // Sort by year desc, then journal asc
        info: true,
        searching: true,
        responsive: true,
        language: {
          info: "Showing _START_ to _END_ of _TOTAL_ entries",
          infoEmpty: "No data available",
          zeroRecords: "No data found",
          lengthMenu: "Show _MENU_ entries per page",
          search: "Search:",
          paginate: {
            first: "First",
            last: "Last",
            next: "Next",
            previous: "Previous"
          }
        }
      });
    }

    // Update all charts and data
    function updateCharts() {
      createMultipleAuthorsPlot();
      createSingleAuthorsPlot();
      updateSummaryStats();
    }

    // Initialize the dashboard
    window.addEventListener('DOMContentLoaded', function() {
      createFilterButtons();
      createMultipleAuthorsPlot();
      createSingleAuthorsPlot();
      updateSummaryStats();
      updateTable();
      
      // Initialize tooltips
      $('[title]').tooltip();
    });
  </script>
</body>
</html>